!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Hooker=e()}(this,function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e,s,r,i={exports:{}};var o=function(){if(r)return i.exports;r=1;const t=s?e:(s=1,e=class{constructor(t){this.hook=t,this.callbacks=new Map,this.isSorted=!0}add(t,e,s){const r={func:t,accepted_args:s};this.callbacks.has(e)||this.callbacks.set(e,[]),this.callbacks.get(e).push(r),this.isSorted=!1}remove(t,e){let s=!1;const r=e=>{const r=this.callbacks.get(e),i=r.findIndex(e=>e.func===t);return-1!==i&&(r.splice(i,1),0===r.length&&this.callbacks.delete(e),s=!0,!0)};if(void 0!==e)this.callbacks.has(e)&&r(e);else for(const t of this.callbacks.keys())if(r(t))break;return s}removeAll(t){void 0!==t?this.callbacks.delete(t):this.callbacks.clear()}has(t){if(0===this.callbacks.size)return!1;if(!t)return!0;for(const e of this.callbacks.values())if(e.some(e=>e.func===t))return!0;return!1}exec(...t){if(0!==this.callbacks.size){this.sort();for(const e of this.callbacks.values())for(const{func:s,accepted_args:r}of e)s(...t.slice(0,r))}}apply(t,...e){if(0===this.callbacks.size)return t;this.sort();let s=t;for(const t of this.callbacks.values())for(const{func:r,accepted_args:i}of t){const t=[s,...e].slice(0,i);s=r(...t)}return s}sort(){this.isSorted||(this.callbacks=new Map([...this.callbacks.entries()].sort((t,e)=>t[0]-e[0])),this.isSorted=!0)}});class o{constructor(){this.hooks=new Map,this.actionCounter=new Map,this.currentActions=[],this.currentFilters=[]}_getHook(e){return this.hooks.has(e)||this.hooks.set(e,new t(e)),this.hooks.get(e)}add(t,e,s=10,r=1){"function"==typeof e?this._getHook(t).add(e,s,r):console.error(`The callback for hook '${t}' must be a function.`)}add_action(t,e,s=10,r=1){this.add(t,e,s,r)}add_filter(t,e,s=10,r=1){this.add(t,e,s,r)}remove(t,e,s){return!!this.hooks.has(t)&&this._getHook(t).remove(e,s)}remove_action(t,e,s){return this.remove(t,e,s)}remove_filter(t,e,s){return this.remove(t,e,s)}remove_all(t,e){this.hooks.has(t)&&this._getHook(t).removeAll(e)}remove_all_actions(t,e){this.remove_all(t,e)}remove_all_filters(t,e){this.remove_all(t,e)}has(t,e=!1){return this.hooks.has(t)&&this._getHook(t).has(e)}has_action(t,e=!1){return this.has(t,e)}has_filter(t,e=!1){return this.has(t,e)}do_action(t,...e){if(!this.hooks.has(t))return;const s=this.actionCounter.get(t)||0;this.actionCounter.set(t,s+1),this.currentActions.push(t);try{this._getHook(t).exec(...e)}finally{this.currentActions.pop()}}do_action_ref_array(t,e=[]){this.do_action(t,...e)}apply_filters(t,e,...s){if(!this.hooks.has(t))return e;this.currentFilters.push(t);try{return this._getHook(t).apply(e,...s)}finally{this.currentFilters.pop()}}apply_filters_ref_array(t,e=[]){return this.apply_filters(t,...e)}did_action(t){return this.actionCounter.get(t)||0}current_action(){return this.currentActions.length>0?this.currentActions[this.currentActions.length-1]:null}current_filter(){return this.currentFilters.length>0?this.currentFilters[this.currentFilters.length-1]:null}doing_action(t=null){return null===t?this.currentActions.length>0:this.currentActions.includes(t)}doing_filter(t=null){return null===t?this.currentFilters.length>0:this.currentFilters.includes(t)}exec(t,...e){this.do_action(t,...e)}apply(t,e,...s){return this.apply_filters(t,e,...s)}filter(t,e,...s){return this.apply_filters(t,e,...s)}}return i.exports=new o,i.exports.Hooker=o,i.exports}();return t(o)});
